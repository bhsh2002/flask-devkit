# 29. هيكلة استجابات القوائم: `create_pagination_schema`

عندما تُرجع واجهة برمجة التطبيقات (API) قائمة من السجلات (مثل قائمة المستخدمين)، من المهم أن تكون الاستجابة دائمًا بنفس الهيكل. هذا يسهل على مطوري الواجهة الأمامية (Frontend) بناء المكونات التي تتعامل مع هذه البيانات.

`create_pagination_schema` هي دالة مصنع (factory function) مسؤولة عن إنشاء `Schema` قياسي وموحد لجميع استجابات القوائم المقسمة إلى صفحات.

## الغرض

الغرض من هذه الدالة هو إنشاء "مغلف" (envelope) قياسي للاستجابات المقسمة إلى صفحات. هذا المغلف يحتوي على قسمين رئيسيين:
1.  `items`: قائمة السجلات الفعلية.
2.  `pagination`: كائن يحتوي على جميع المعلومات الوصفية حول التقسيم إلى صفحات.

## كيف تعمل؟

- **المدخلات:** تأخذ الدالة مُعلمًا واحدًا: `item_schema`، وهو فئة الـ `Schema` التي تمثل عنصرًا واحدًا في القائمة (e.g., `UserSchema`).
- **المخرجات:** تُرجع فئة `Schema` جديدة ومخصصة للاستجابة المقسمة إلى صفحات.

### هيكل الاستجابة الناتج

أي استجابة يتم تنسيقها بواسطة `Schema` تم إنشاؤه عبر هذه الدالة سيكون لها هيكل JSON التالي:

```json
{
  "items": [
    {
      "uuid": "a1b2c3d4-...",
      "username": "alice"
      // ... باقي حقول العنصر
    },
    {
      "uuid": "e5f6g7h8-...",
      "username": "bob"
      // ... باقي حقول العنصر
    }
  ],
  "pagination": {
    "total": 150,
    "page": 3,
    "per_page": 10,
    "total_pages": 15,
    "has_next": true,
    "has_prev": true
  }
}
```

### تفاصيل كائن `pagination`

- **`total`**: العدد الإجمالي للسجلات المتاحة.
- **`page`**: رقم الصفحة الحالية.
- **`per_page`**: عدد السجلات في كل صفحة.
- **`total_pages`**: العدد الإجمالي للصفحات.
- **`has_next`**: `true` إذا كانت هناك صفحة تالية.
- **`has_prev`**: `true` إذا كانت هناك صفحة سابقة.

## الاستخدام

**عادة، لا تحتاج إلى استدعاء هذه الدالة بنفسك.**

تقوم دالة `create_crud_schemas` باستدعائها تلقائيًا لإنشاء `Schema` المسمى `pagination_out`. يتم بعد ذلك استخدام هذا الـ `Schema` بواسطة `register_crud_routes` لنقاط النهاية التي تعرض قوائم (e.g., `GET /users`).

إن فهم هذا الهيكل ضروري لأي شخص سيقوم باستهلاك واجهة برمجة التطبيقات (API) التي تم إنشاؤها بواسطة `Flask-DevKit`.
